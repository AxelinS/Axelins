---
layout: post
title:  "Inteligencia Artificial que juga Osu!"
date:   2024-05-16
excerpt: "IA capaz de jugar al videojuego Osu! su actual presicion es 99% punteria, 60% click"
tag:
- IA
- Gaming
- Tensorflow
- Pytorch
- Deep Learning
- Deep Q Learning
---

## IA que juega Osu!
Comencé a crear esta inteligencia artificial a finales de agosto de 2023 y actualmente posee una precisión del 99% en puntería en casi cualquier nivel. 
Esta fue entrenada utilizando varias replays grabadas y sincronizando el video con las coordenadas y click que se dio en cada frame de video.

Al buscar fuentes encontré que OpenAI había logrado hacer funcionar una IA que juega minecraft utilizando una técnica llamada video pretraining, esto me sirvió de inspiración para probar este método con mi modelo que juega Osu!.
Esta técnica funcionó de una manera fenomenal en la puntería del modelo, aunque en la parte del click aún fallaba bastante.

Aunque originalmente inicié el proyecto con Tensorflow y logré conseguir buenos resultados, decidí aprender también un poco de Pytorch y al final hice una versión más rápida y precisa que la que tenía en Tensorflow.

Actualmente estoy perfeccionando con deep Q learning la parte del click para aumentar su constancia con la que da los clicks justo a tiempo para obtener el mejor puntaje.

### Modelo
Su input es una secuencia de imágenes con dimensiones 6x60x80x1 (Secuencia, Alto, Ancho, Color) la cual pasa dos resnet 18, una resnet se encarga de obtener los detalles más importantes para la parte de la puntería mientras que la otra busca los detalles más importantes para el click, encontré que con este método de dos resnet obtengo resultados más precisos en lugar de compartir una para ambas acciones.
Cabe aclarar que cada salida de la resnet está conectada a 2 capas LSTM con densidad de 512 y luego pasa a 2 capas densas con activación ReLU, una de 512 neuronas y la otra de 256.
Para las salidas en cuanto a la puntería se espera un array con las coordenadas [x,y] y para el click simplemente un número entre 1 y 0 que da la probabilidad de dar click o no.

### Funcionamiento
Para poner en marcha la IA simplemente abro Osu! y ejecuto un script de python el cual comienza a tomar capturas de pantalla del juego todo el tiempo, las capturas se guardan en secuencia de 6 dentro de un tensor el cual es enviado en un pipe hacia la parte encargada de la inferencia. 
Cuando entro a una partida solo activo el ciclo que se encarga de las inferencias y las salidas como las coordenadas [x,y] las proceso y haciendo uso de ctypes se mueve  el cursor a las coordenadas.
Con la parte del click es sencillo, solamente de la salida se identifica la probabilidad del click y en base a esta se presiona la tecla “x” para dar el equivalente al click en el juego.

### Mi experiencia
Este fue mi primer proyecto relacionado con la inteligencia artificial y al comenzar a crearlo descubrí que es un área que me gusta un montón y me emociona aprender mucho más.
Aprendí y pase por muchas etapas de aprendizaje realizando este proyecto, aprendí desde cómo hacer un modelo básico simple de una entrada, una capa oculta y una salida para hacer una simple conversión de fahrenheit a celsius a un modelo de reconocimiento de imágenes y otro de detección de objetos solo para poder entender las bases para realizar este, mi primer proyecto.

He estado varios meses pasando por dificultades y resolviendo los problemas que me encontraba, aprendiendo desde cero a crear una inteligencia artificial, al ser este mi primer proyecto me tomó mucho tiempo llegar a tener unos resultados que cumplieran mis expectativas (Que la IA pudiese ganarle a un humano).

Probé diferentes técnicas y arquitecturas para el modelo haciendo un montón de pruebas incluso dejando el modelo entrenando por días. 

Se podría decir que gracias a este proyecto descubrí mi pasión por la inteligencia artificial.

### Especificaciones del equipo utilizado
Ryzen 5 5500
RTX 3060 12GB
32GB RAM DDR4 2666MHz
Windows 10

* <a href="https://clips.twitch.tv/ProudDignifiedDonkeyStrawBeary-DJJ4h0AaHFeaybmi">Video demostrativo de la punteria</a>